# 图神经网络（GNN）

### 1.  GNN定义

- **图神经网络（GNN）**是一种专门用于处理**图结构数据**的深度学习模型，能够对节点、边或整个图进行特征学习和预测。其核心思想是通过**消息传递机制**聚合邻居信息，捕捉数据中的拓扑关系和属性特征。



### 2.  核心原理

#### 2.1 消息传递框架

- **邻居聚合** ：每个节点通过聚合其邻居节点的特征更新自身状态。

- **迭代更新**：通过多轮消息传递，节点特征逐渐融合全局结构信息。

- **数学描述**：

  - **节点更新**：
    $$
    h_v^{(l)} = f_{\text{update}} \left( h_v^{(l-1)}, \text{Aggregate}\left(\{ h_u^{(l-1)} \mid u \in \mathcal{N}(v) \}\right) \right)
    $$

    - $h_v^{(l)}$：节点$V$在第$l$层的特征
    - $\mathcal{N}(v) $：节点$v$的邻居集合
    - $f_{\text{update}}$：更新函数
    - $\text{Aggregate}$：聚合函数（如求和、均值、最大值）

  - **边与图级别**：

    类似地，边和图级别的表示可通过节点特征进一步聚合得到。

#### 2.2 经典变体

| **模型**          | **核心思想**         |
| --------------- | ---------------- |
| **GCN**(图卷积网络)  | 基于谱图理论，简化卷积操作    |
| **GAT**(图注意力网络) | 引入注意力机制，动态加权邻居贡献 |
| **GraphSAGE**   | 采样固定数量邻居，支持归纳学习  |



### 3.  核心组件

| **组件**     | **功能**                | **示例**                     |
| ---------- | --------------------- | -------------------------- |
| **节点特征矩阵** | 存储节点的初始特征（如用户属性、原子类型） | $X∈R^{N×d}$（N为节点数）         |
| **邻接矩阵**   | 描述图结构（边连接关系）          | $A∈{0,1}^{N×N}$            |
| **聚合函数**   | 合并邻居信息                | 求和（Sum）、均值（Mean）、最大值（Max）  |
| **更新函数**   | 生成节点新状态               | MLP、GRU                    |
| **读出函数**   | 生成图级别表示（用于图分类）        | 全局池化（Global Pooling）、层次化聚合 |



### 4.  应用场景

#### 4.1 典型领域

- **社交网络**：用户推荐、社区检测。
- **化学/生物**：分子性质预测（如溶解度、毒性）、蛋白质相互作用。
- **推荐系统**：基于用户-商品二部图的个性化推荐。
- **交通网络**：交通流量预测、路径规划。
- **知识图谱**：实体链接、关系推理。

#### 4.2 应用宝案例

- **微信社交推荐**：利用用户关系图优化好友推荐。
- **阿里商品推荐**：基于用户-商品交互图的GNN模型。
- **腾讯药物发现**：预测分子活性，加速新药研发。



### 5.  优缺点

#### 5.1 优点

- 直接处理非欧几里得数据（图结构）
- 自动捕捉拓扑关系与节点属性
- 支持节点/边/图级别的任务
- 可解释性优于传统DNN（通过注意力）

#### 5.2 缺点

- 计算复杂度高（大规模图需要采样或近似）
- 超参数敏感（如聚合方式、层数）
- 动态图处理能力有限
- 需要高质量的图结构数据

